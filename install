#!/usr/bin/env ruby
begin
  require 'rubygems'
  require 'rainbow'
rescue LoadError => e
  puts "Rainbow gem not present."
  puts "Run 'gem install rainbow and try again."
  exit
end
using Rainbow

path = File.join(File.dirname(File.absolute_path(__FILE__)))
actors_path = actors_path = File.join(path, 'actors')
Dir[File.join(actors_path, '*')].each {|file| require file }

class Director

  def initialize(path)
    @path = path
  end

  def run_actors(actors)
    actors = Array(actors)
    puts Rainbow('Executing these actors: ').mediumpurple + actors.join(', ')
    actors.each do |actor|
      if actor.respond_to? :do
        exit unless actor.do(@path)
      end

      if actor.respond_to? :setup
        exit unless actor.setup(@path)
      end
    end
  end
end

director = Director.new path

system_and_apps = [
  SudoUpFront,
  XcodeSierra,
  SystemName,
  WorkspaceDir,
  Homebrew,
  Rcm,
  MacOsDefaults
]

ruby_development = [
  RubyInstall,
  Bundler
]

#director.run_actors system_and_apps
#director.run_actors ruby_development
director.run_actors Rcm
